"0","com_clust <- function(data,variables = c(1:ncol(data)),weight= 1){"
"0","adjmatrix <- 1- daisy(data[,variables], metric = c(""gower""), weights = weight) # ungewichteter Vergleich, ausgenommen e0, e1, da nur ein auftreten Ã¼berhaupt"
"0",""
"0","x <- as.matrix(adjmatrix) #schreibt Aehnlichkeitsmatrix in ein R Objekt"
"0",""
"0","g1 <- graph_from_adjacency_matrix(x, mode = c(""lower""), weighted = TRUE, diag = FALSE, add.colnames = NULL, add.rownames = NA) #erstellt Graphfile aus unterer H??lfte der Aehnlichkeitsmatrix"
"0",""
"0","cfg <- cluster_louvain(g1, weights = NULL) #sucht im Graphen nach Gruppen"
"0",""
"0","#plot(cfg, g1, vertex.size=10, vertex.label.font=20, family=""serif"", edge.width=E(g1)$weight, sub= stringr::str_c(""Modularity="",modularity(cfg))) #Zeichnet Graphen samt Gruppierungen"
"0",""
"0","group <- as.factor(membership(cfg))"
"0","data <- cBind(data,group)"
"0",""
"0","return(list(data,"
"0","plot(cfg, g1, vertex.size=10, vertex.label.font=20, family=""serif"", edge.width=E(g1)$weight, sub= stringr::str_c(""Modularity="",modularity(cfg)))))"
"0","}"
